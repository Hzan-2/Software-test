#Lending进行PCSM复核
-
  Step: Given
  Text: 进行PCSM复核
  Fixture: web
  Process:
    #切换账户，退出当前用户
    -
      Action: click
      Element: //*[@id='main_sys']/ul/li[6]/a
      TestData:
      Remarks: 点击退出按钮
    -
      Action: sleep
      Element:
      TestData: 5
      Remarks: 等待5秒
    -
      Action: alert
      Element:
      TestData:
      Remarks: 关闭弹窗
    -
      Action: sleep
      Element:
      TestData: 5
      Remarks: 等待5秒
    #登录有审批权限的用户-wanghuan
    -
      Action: sleep
      Element:
      TestData: 2
      Remarks: 停顿2秒
    -
      Action: get_text
      Element: $${user}
      TestData: ${Lending}${userName_wang}
      Remarks: 赋值账号
    -
      Action: get_text
      Element: $${password}
      TestData: ${Lending}${password_wang}
      Remarks: 赋值密码
    -
      Action: get_text
      Element: $${SystemException}
      TestData: 0
      Remarks: 赋值0
    -
      Action: loop
      Element: $${SystemException}
      TestData: 3
      Remarks: 进入循环，当值为3，跳出循环
      branchProcess:
        -
          Action: compare
          Element:
          TestData: $${SystemException} != 3
          Remarks: 如果值不等于3，走if分支
          ifbranchProcess:
            -
              Action: judge,branch
              Element: //*[@id='details-button']
              TestData:
              Remarks: 判断是否存在高级按钮，若存在，走if分支
              ifbranchProcess:
                -
                  Action: click
                  Element: //*[@id='details-button']
                  TestData:
                  Remarks: 点击高级
                -
                  Action: click
                  Element: //*[@id='proceed-link']
                  TestData:
                  Remarks: 点击进入链接
                -
                  Action: sleep
                  Element:
                  TestData: 2
                  Remarks: 停顿2秒
                -
                  Action: click
                  Element: //*[@id='details-button']
                  TestData:
                  Remarks: 点击高级
                -
                  Action: sleep
                  Element:
                  TestData: 2
                  Remarks: 停顿2秒
                -
                  Action: click
                  Element: //*[@id='proceed-link']
                  TestData:
                  Remarks: 点击进入链接
                -
                  Action: sleep
                  Element:
                  TestData: 2
                  Remarks: 停顿2秒
              elsebranchProcess:
                -
                  Action: sleep
                  Element:
                  TestData: 1
                  Remarks: 不存在高级按钮
            -
              Action: input
              Element: //*[@id='loginid']
              TestData: $${user}
              Remarks: 输入账号
            -
              Action: input
              Element: //*[@id='password']
              TestData: $${password}
              Remarks: 输入密码
            -
              Action: sleep
              Element:
              TestData: 1
              Remarks: 停顿1秒
            -
              Action: judge,branch
              Element: //*[@id='login']/div[1]/span
              TestData:
              Remarks: 判断是否存在该元素，若存在，走if分支
              ifbranchProcess:
                -
                  Action: input
                  Element: //*[@id='login']/div[4]/input
                  TestData: 123
                  Remarks: 输入验证码
              elsebranchProcess:
                -
                  Action: input
                  Element: //*[@id='login']/div[3]/input
                  TestData: 123
                  Remarks: 输入验证码
            -
              Action: sleep
              Element:
              TestData: 1
              Remarks: 停顿1秒
            -
              Action: click
              Element: //*[@id='sub']
              TestData:
              Remarks: 点击登录
            -
              Action: sleep
              Element:
              TestData: 2
              Remarks: 停顿2秒
            -
              Action: judge,branch
              Element: //*[@id='login']/div[1]/span
              TestData:
              Remarks: 判断是否存在该元素，若存在，走if分支
              ifbranchProcess:
                -
                  Action: sleep
                  Element:
                  TestData: 1
                  Remarks: 登录失败
                -
                  Action: get_text
                  Element: $${SystemException}
                  TestData: $${SystemException}+1
                  Remarks: SystemException+1
              elsebranchProcess:
                -
                  Action: sleep
                  Element:
                  TestData: 1
                  Remarks: 进入循环，登录成功
                -
                  Action: get_text
                  Element: $${SystemException}
                  TestData: 3
                  Remarks: 赋值3
          elsebranchProcess:
            -
              Action: sleep
              Element:
              TestData: 1
              Remarks: 登录成功
    -
      Action: sleep
      Element:
      TestData: 1
      Remarks: 等待1秒
#PCSM复核
    -
      Action: sleep
      Element:
      TestData: 5
      Remarks: 进入Pcsm人工复核
    -
      Action: mouse
      Element: ${LendingElement}${CreditProcessElement}
      TestData: hover
      Remarks: 将鼠标悬停在授信流程上
    -
      Action: click
      Element: ${LendingElement}${ApprovalAndReviewElement}
      TestData:
      Remarks: 点击”Livi Cash/Livi PayLater审查审批“
    -
      Action: iframe
      Element: ${LendingElement}${CreditIframe6}
      TestData:
      Remarks: 切入iframe6
    -
      Action: sleep
      Element:
      TestData: 2
      Remarks: 等待2秒
    -
      Action: click
      Element: ${LendingElement}${PcsmManualToReviewElement}
      TestData:
      Remarks: 点击”pcsm人工复核“
    -
      Action: iframe
      Element: ${LendingElement}${CreditIframe16}
      TestData:
      Remarks: 切入iframe16
    -
      Action: sleep
      Element:
      TestData: 5
      Remarks: 等待5秒
    -
      Action: iframe
      Element: ${LendingElement}${CreditIframe8}
      TestData:
      Remarks: 切入iframe8
    -
      Action: click
      Element: ${LendingElement}${GetTaskButtonElement}
      TestData:
      Remarks: 点击”自动获取任务“
    -
      Action: sleep
      Element:
      TestData: 2
      Remarks: 等待2秒
    -
      Action: q_iframe
      Element:
      TestData:
      Remarks: 切出iframe8
    -
      Action: q_iframe
      Element:
      TestData:
      Remarks: 切出iframe16
    -
      Action: q_iframe
      Element:
      TestData:
      Remarks: 切出iframe6
    -
      Action: sleep
      Element:
      TestData: 5
      Remarks: 等待5秒
    -
      Action: iframe
      Element: ${LendingElement}${CreditIframe4}
      TestData:
      Remarks: 切入iframe4
    -
      Action: iframe
      Element: ${LendingElement}${CreditIframe5}
      TestData:
      Remarks: 切入iframe5
    -
      Action: click
      Element: ${LendingElement}${SearchButtonElement}
      TestData:
      Remarks: 点击搜索按钮
    -
      Action: input
      Element: ${LendingElement}${InputCustomerIdElement}
      TestData: ${Lending}${CustomerId}
      Remarks: 输入客户号
    -
      Action: click
      Element: ${LendingElement}${ConfirmButtonElement}
      TestData:
      Remarks: 点击确定按钮
    -
      Action: q_iframe
      Element:
      TestData:
      Remarks: 切出iframe5
    -
      Action: click
      Element: ${LendingElement}${ConfirmButtonElement1}
      TestData:
      Remarks: 点击确定按钮
    -
      Action: sleep
      Element:
      TestData: 3
      Remarks: 等待3秒
    -
      Action: alert
      Element:
      TestData:
      Remarks: 关闭弹窗
    -
      Action: sleep
      Element:
      TestData: 3
      Remarks: 等待3秒
    -
      Action: q_iframe
      Element:
      TestData:
      Remarks: 切出iframe4
#判断是否有值
    -
      Action: judge,branch
      Element: /html/body/div[5]/div/table/tbody/tr[1]/td/div
      TestData:
      Remarks: 判断是否弹窗是否依然存在可选取的审批任务,存在走if
      ifbranchProcess:
        -
          Action: click
          Element: /html/body/div[5]/div/table/tbody/tr[1]/td/button
          TestData:
          Remarks: 关闭弹窗
      elsebranchProcess:
        -
          Action: iframe
          Element: ${LendingElement}${CreditIframe6}
          TestData:
          Remarks: 切入iframe6
        -
          Action: sleep
          Element:
          TestData: 2
          Remarks: 等待2秒
        -
          Action: iframe
          Element: ${LendingElement}${CreditIframe16}
          TestData:
          Remarks: 切入iframe16
        -
          Action: iframe
          Element: ${LendingElement}${CreditIframe8}
          TestData:
          Remarks: 切入iframe8
        -
          Action: click
          Element: ${LendingElement}${SearchButtonElement}
          TestData:
          Remarks: 点击搜索按钮
        -
          Action: sleep
          Element:
          TestData: 3
          Remarks: 等待3秒
        -
          Action: input
          Element: ${LendingElement}${InputCustomerNameElement}
          TestData: ${Lending}${CustomerName}
          Remarks: 输入客户名称
        -
          Action: click
          Element: ${LendingElement}${ConfirmButtonElement}
          TestData:
          Remarks: 点击确定按钮
        -
          Action: sleep
          Element:
          TestData: 5
          Remarks: 等待5秒
        -
          Action: click
          Element: ${LendingElement}${ApplyDetailsButtonElement}
          TestData:
          Remarks: 申请详情
        -
          Action: q_iframe
          Element:
          TestData:
          Remarks: 切出iframe8
        -
          Action: q_iframe
          Element:
          TestData:
          Remarks: 切出iframe13
        -
          Action: q_iframe
          Element:
          TestData:
          Remarks: 切出iframe6
        -
          Action: sleep
          Element:
          TestData: 2
          Remarks: 等待2秒
        -
          Action: iframe
          Element: ${LendingElement}${CreditIframe4}
          TestData:
          Remarks: 切入iframe9
        -
          Action: iframe
          Element: ${LendingElement}${CreditIframe14}
          TestData:
          Remarks: 切入iframe14
        -
          Action: click
          Element: ${LendingElement}${SignCommentsButtonElement}
          TestData:
          Remarks: 点击签署意见
        -
          Action: iframe
          Element: ${LendingElement}${CreditIframe15}
          TestData:
          Remarks: 切入iframe15
        -
          Action: sleep
          Element:
          TestData: 5
          Remarks: 等待5秒
        -
          Action: iframe
          Element: ${LendingElement}${CreditIframe11}
          TestData:
          Remarks: 切入iframe11
        -
          Action: click
          Element: ${LendingElement}${AgreeButtonElement}
          TestData:
          Remarks: 选择同意
        -
          Action: input
          Element: ${LendingElement}${RemarksElement}
          TestData: PCSM人工复核
          Remarks: 录入备注
        -
          Action: sleep
          Element:
          TestData: 10
          Remarks: 等待11秒
        -
          Action: click
          Element: ${LendingElement}${PreservationAndQueryPcsmButtonElement}
          TestData:
          Remarks: 点击保存并查询决策引擎
        -
          Action: sleep
          Element:
          TestData: 2
          Remarks: 等待2秒
          #需要判断是否有弹窗，后续增加
        -
          Action: alert
          Element:
          TestData:
          Remarks: 关闭弹窗
        -
          Action: sleep
          Element:
          TestData: 2
          Remarks: 等待2秒
        -
          Action: q_iframe
          Element:
          TestData:
          Remarks: 切出iframe11
        -
          Action: q_iframe
          Element:
          TestData:
          Remarks: 切出iframe15
        -
          Action: click
          Element: ${LendingElement}${SubmitButtonElement}
          TestData:
          Remarks: 点击提交
        -
          Action: sleep
          Element:
          TestData: 5
          Remarks: 等待5秒
        -
          Action: q_iframe
          Element:
          TestData:
          Remarks: 切出iframe14
        -
          Action: q_iframe
          Element:
          TestData:
          Remarks: 切出iframe9
        -
          Action: iframe
          Element: ${LendingElement}${CreditIframe12}
          TestData:
          Remarks: 切入iframe13
        -
          Action: click
          Element: ${LendingElement}${CallNextStepElement}
          TestData:
          Remarks: 选择批准
        -
          Action: click
          Element: ${LendingElement}${ApproverNextStepElement}
          TestData:
          Remarks: 选择系统管理员
        -
          Action: click
          Element: ${LendingElement}${SubmitButtonElement1}
          TestData:
          Remarks: 点击提交
        -
          Action: sleep
          Element:
          TestData: 3
          Remarks: 等待3秒
        -
          Action: alert
          Element:
          TestData:
          Remarks: 关闭弹窗
        -
          Action: sleep
          Element:
          TestData: 3
          Remarks: 等待3秒
        -
          Action: alert
          Element:
          TestData:
          Remarks: 关闭弹窗
        -
          Action: sleep
          Element:
          TestData: 3
          Remarks: 等待3秒
        -
          Action: q_iframe
          Element:
          TestData:
          Remarks: 切入iframe13
        -
          Action: sleep
          Element:
          TestData: 2
          Remarks: 等待2秒